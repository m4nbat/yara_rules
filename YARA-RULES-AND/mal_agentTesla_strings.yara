rule AgentTesla_DIFF_Common_Strings_01
{
	meta:
		date = "2023-09-11"
		yarahub_uuid = "4e0b52b0-18c7-4d19-8df0-3b0618c315ee"
		yarahub_license = "CC0 1.0"
		yarahub_rule_matching_tlp = "TLP:WHITE"
		yarahub_rule_sharing_tlp = "TLP:WHITE"
		yarahub_reference_md5 = "c90459986070e38fd8260d4430e23dfd"
		author = "schmidtsz"
		description = "Identify partial Agent Tesla strings"
  strings:
    $0 = "b77a5c561934e089"
    $1 = {644174747269627574650047656E657261746564436F64654174747269627574650044656275676765724E6F6E55736572436F64654174747269627574650044656275676761626C65417474726962757465}
    $2 = "PublicKeyToken=b03f5f7f11d50a3aPADPAD"
    $3 = {61626C6541747472696275746500456469746F7242726F777361626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500}
    $4 = {353631393334653038392353797374656D2E5265736F75726365732E52756E74696D655265736F7572636553657402000000000000000000000050414450414450B4000000}
    $5 = "<requestedExecutionLevel level=\"asInvoker\" uiAccess=\"false\""
    $6 = {6365732E546F6F6C732E5374726F6E676C7954797065645265736F757263654275696C6465720831362E302E302E300000}
    $7 = {353631393334653038392353797374656D2E5265736F75726365732E52756E74696D655265736F7572636553657402000000010000}
    $8 = {6564436F64654174747269627574650044656275676765724E6F6E55736572436F646541747472696275746500}
    $9 = {65616441747472696275746500436F6D70696C657247656E6572617465644174747269627574650047}
    $10 = {63616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300}
    $11 = {63616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A240000000000000050450000}
    $12 = {4C006500670061006C00540072006100640065006D00610072006B0073}
    $13 = {41007300730065006D0062006C0079002000560065007200730069006F006E}
    $14 = {63657074696F6E5468726F777301080100}
    $15 = {65436F6D7061746962696C69747941747472696275746500}
    $16 = {6541747472696275746500417373656D626C79}
    $17 = {6164656D61726B41747472696275746500}
    $18 = "b03f5f7f11d50a3a"
  condition:
    41% of them
}  

rule is_not_AgentTesla_DIFF_Common_Strings_01 
{
    condition:
        not  AgentTesla_DIFF_Common_Strings_01
}